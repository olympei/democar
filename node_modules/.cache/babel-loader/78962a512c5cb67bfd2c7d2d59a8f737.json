{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = require('babel-runtime/helpers/createClass');\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require('babel-runtime/helpers/inherits');\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _core = require('@aws-amplify/core');\n\nvar _auth = require('@aws-amplify/auth');\n\nvar _auth2 = _interopRequireDefault(_auth);\n\nvar _AuthPiece2 = require('./AuthPiece');\n\nvar _AuthPiece3 = _interopRequireDefault(_AuthPiece2);\n\nvar _FederatedSignIn = require('./FederatedSignIn');\n\nvar _AmplifyTheme = require('../AmplifyTheme');\n\nvar _AmplifyTheme2 = _interopRequireDefault(_AmplifyTheme);\n\nvar _AmplifyUI = require('../AmplifyUI');\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nvar logger = new _core.ConsoleLogger('SignIn');\n/*\n * Copyright 2017-2017 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *     http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\n\nvar SignIn = function (_AuthPiece) {\n  (0, _inherits3.default)(SignIn, _AuthPiece);\n\n  function SignIn(props) {\n    (0, _classCallCheck3.default)(this, SignIn);\n\n    var _this = (0, _possibleConstructorReturn3.default)(this, (SignIn.__proto__ || Object.getPrototypeOf(SignIn)).call(this, props));\n\n    _this.checkContact = _this.checkContact.bind(_this);\n    _this.signIn = _this.signIn.bind(_this);\n    _this.onKeyDown = _this.onKeyDown.bind(_this);\n    _this._validAuthStates = ['signIn', 'signedOut', 'signedUp'];\n    _this.state = {};\n    return _this;\n  }\n\n  (0, _createClass3.default)(SignIn, [{\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      window.addEventListener('keydown', this.onKeyDown);\n    }\n  }, {\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      window.removeEventListener('keydown', this.onKeyDown);\n    }\n  }, {\n    key: 'onKeyDown',\n    value: function onKeyDown(e) {\n      if (this.props.authState === 'signIn' && !this.props.hide) {\n        if (e.keyCode === 13) {\n          // when press enter\n          this.signIn();\n        }\n      }\n    }\n  }, {\n    key: 'checkContact',\n    value: function checkContact(user) {\n      var _this2 = this;\n\n      if (!_auth2.default || typeof _auth2.default.verifiedContact !== 'function') {\n        throw new Error('No Auth module found, please ensure @aws-amplify/auth is imported');\n      }\n\n      _auth2.default.verifiedContact(user).then(function (data) {\n        if (!_core.JS.isEmpty(data.verified)) {\n          _this2.changeState('signedIn', user);\n        } else {\n          user = Object.assign(user, data);\n\n          _this2.changeState('verifyContact', user);\n        }\n      });\n    }\n  }, {\n    key: 'signIn',\n    value: function signIn() {\n      var _this3 = this;\n\n      var _inputs = this.inputs,\n          username = _inputs.username,\n          password = _inputs.password;\n\n      if (!_auth2.default || typeof _auth2.default.signIn !== 'function') {\n        throw new Error('No Auth module found, please ensure @aws-amplify/auth is imported');\n      }\n\n      _auth2.default.signIn(username, password).then(function (user) {\n        logger.debug(user);\n\n        if (user.challengeName === 'SMS_MFA' || user.challengeName === 'SOFTWARE_TOKEN_MFA') {\n          logger.debug('confirm user with ' + user.challengeName);\n\n          _this3.changeState('confirmSignIn', user);\n        } else if (user.challengeName === 'NEW_PASSWORD_REQUIRED') {\n          logger.debug('require new password', user.challengeParam);\n\n          _this3.changeState('requireNewPassword', user);\n        } else if (user.challengeName === 'MFA_SETUP') {\n          logger.debug('TOTP setup', user.challengeParam);\n\n          _this3.changeState('TOTPSetup', user);\n        } else {\n          _this3.checkContact(user);\n        }\n      }).catch(function (err) {\n        if (err.code === 'UserNotConfirmedException') {\n          logger.debug('the user is not confirmed');\n\n          _this3.changeState('confirmSignUp');\n        } else {\n          _this3.error(err);\n        }\n      });\n    }\n  }, {\n    key: 'showComponent',\n    value: function showComponent(theme) {\n      var _this4 = this;\n\n      var _props = this.props,\n          authState = _props.authState,\n          hide = _props.hide,\n          federated = _props.federated,\n          onStateChange = _props.onStateChange;\n\n      if (hide && hide.includes(SignIn)) {\n        return null;\n      }\n\n      return _react2.default.createElement(_AmplifyUI.FormSection, {\n        theme: theme\n      }, _react2.default.createElement(_AmplifyUI.SectionHeader, {\n        theme: theme\n      }, _core.I18n.get('Sign In Account')), _react2.default.createElement(_AmplifyUI.SectionBody, {\n        theme: theme\n      }, _react2.default.createElement(_AmplifyUI.InputRow, {\n        autoFocus: true,\n        placeholder: _core.I18n.get('Username'),\n        theme: theme,\n        key: 'username',\n        name: 'username',\n        onChange: this.handleInputChange\n      }), _react2.default.createElement(_AmplifyUI.InputRow, {\n        placeholder: _core.I18n.get('Password'),\n        theme: theme,\n        key: 'password',\n        type: 'password',\n        name: 'password',\n        onChange: this.handleInputChange\n      }), _react2.default.createElement(_AmplifyUI.ButtonRow, {\n        theme: theme,\n        onClick: this.signIn\n      }, _core.I18n.get('Sign In')), _react2.default.createElement(_FederatedSignIn.FederatedButtons, {\n        federated: federated,\n        theme: theme,\n        authState: authState,\n        onStateChange: onStateChange\n      })), _react2.default.createElement(_AmplifyUI.SectionFooter, {\n        theme: theme\n      }, _react2.default.createElement('div', {\n        style: theme.col6\n      }, _react2.default.createElement(_AmplifyUI.Link, {\n        theme: theme,\n        onClick: function onClick() {\n          return _this4.changeState('forgotPassword');\n        }\n      }, _core.I18n.get('Forgot Password'))), _react2.default.createElement('div', {\n        style: Object.assign({\n          textAlign: 'right'\n        }, theme.col6)\n      }, _react2.default.createElement(_AmplifyUI.Link, {\n        theme: theme,\n        onClick: function onClick() {\n          return _this4.changeState('signUp');\n        }\n      }, _core.I18n.get('Sign Up')))));\n    }\n  }]);\n  return SignIn;\n}(_AuthPiece3.default);\n\nexports.default = SignIn;","map":{"version":3,"sources":["/home/ec2-user/environment/amazon-cognito-identity-management-workshop/website/node_modules/aws-amplify-react/dist/Auth/SignIn.js"],"names":["Object","defineProperty","exports","value","_classCallCheck2","require","_classCallCheck3","_interopRequireDefault","_createClass2","_createClass3","_possibleConstructorReturn2","_possibleConstructorReturn3","_inherits2","_inherits3","_react","_react2","_core","_auth","_auth2","_AuthPiece2","_AuthPiece3","_FederatedSignIn","_AmplifyTheme","_AmplifyTheme2","_AmplifyUI","obj","__esModule","default","logger","ConsoleLogger","SignIn","_AuthPiece","props","_this","__proto__","getPrototypeOf","call","checkContact","bind","signIn","onKeyDown","_validAuthStates","state","key","componentDidMount","window","addEventListener","componentWillUnmount","removeEventListener","e","authState","hide","keyCode","user","_this2","verifiedContact","Error","then","data","JS","isEmpty","verified","changeState","assign","_this3","_inputs","inputs","username","password","debug","challengeName","challengeParam","catch","err","code","error","showComponent","theme","_this4","_props","federated","onStateChange","includes","createElement","FormSection","SectionHeader","I18n","get","SectionBody","InputRow","autoFocus","placeholder","name","onChange","handleInputChange","type","ButtonRow","onClick","FederatedButtons","SectionFooter","style","col6","Link","textAlign"],"mappings":"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","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = require('babel-runtime/helpers/createClass');\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require('babel-runtime/helpers/inherits');\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _core = require('@aws-amplify/core');\n\nvar _auth = require('@aws-amplify/auth');\n\nvar _auth2 = _interopRequireDefault(_auth);\n\nvar _AuthPiece2 = require('./AuthPiece');\n\nvar _AuthPiece3 = _interopRequireDefault(_AuthPiece2);\n\nvar _FederatedSignIn = require('./FederatedSignIn');\n\nvar _AmplifyTheme = require('../AmplifyTheme');\n\nvar _AmplifyTheme2 = _interopRequireDefault(_AmplifyTheme);\n\nvar _AmplifyUI = require('../AmplifyUI');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar logger = new _core.ConsoleLogger('SignIn'); /*\n                                                 * Copyright 2017-2017 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n                                                 *\n                                                 * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n                                                 * the License. A copy of the License is located at\n                                                 *\n                                                 *     http://aws.amazon.com/apache2.0/\n                                                 *\n                                                 * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n                                                 * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n                                                 * and limitations under the License.\n                                                 */\n\nvar SignIn = function (_AuthPiece) {\n    (0, _inherits3.default)(SignIn, _AuthPiece);\n\n    function SignIn(props) {\n        (0, _classCallCheck3.default)(this, SignIn);\n\n        var _this = (0, _possibleConstructorReturn3.default)(this, (SignIn.__proto__ || Object.getPrototypeOf(SignIn)).call(this, props));\n\n        _this.checkContact = _this.checkContact.bind(_this);\n        _this.signIn = _this.signIn.bind(_this);\n        _this.onKeyDown = _this.onKeyDown.bind(_this);\n\n        _this._validAuthStates = ['signIn', 'signedOut', 'signedUp'];\n        _this.state = {};\n        return _this;\n    }\n\n    (0, _createClass3.default)(SignIn, [{\n        key: 'componentDidMount',\n        value: function componentDidMount() {\n            window.addEventListener('keydown', this.onKeyDown);\n        }\n    }, {\n        key: 'componentWillUnmount',\n        value: function componentWillUnmount() {\n            window.removeEventListener('keydown', this.onKeyDown);\n        }\n    }, {\n        key: 'onKeyDown',\n        value: function onKeyDown(e) {\n            if (this.props.authState === 'signIn' && !this.props.hide) {\n                if (e.keyCode === 13) {\n                    // when press enter\n                    this.signIn();\n                }\n            }\n        }\n    }, {\n        key: 'checkContact',\n        value: function checkContact(user) {\n            var _this2 = this;\n\n            if (!_auth2.default || typeof _auth2.default.verifiedContact !== 'function') {\n                throw new Error('No Auth module found, please ensure @aws-amplify/auth is imported');\n            }\n            _auth2.default.verifiedContact(user).then(function (data) {\n                if (!_core.JS.isEmpty(data.verified)) {\n                    _this2.changeState('signedIn', user);\n                } else {\n                    user = Object.assign(user, data);\n                    _this2.changeState('verifyContact', user);\n                }\n            });\n        }\n    }, {\n        key: 'signIn',\n        value: function signIn() {\n            var _this3 = this;\n\n            var _inputs = this.inputs,\n                username = _inputs.username,\n                password = _inputs.password;\n\n            if (!_auth2.default || typeof _auth2.default.signIn !== 'function') {\n                throw new Error('No Auth module found, please ensure @aws-amplify/auth is imported');\n            }\n            _auth2.default.signIn(username, password).then(function (user) {\n                logger.debug(user);\n                if (user.challengeName === 'SMS_MFA' || user.challengeName === 'SOFTWARE_TOKEN_MFA') {\n                    logger.debug('confirm user with ' + user.challengeName);\n                    _this3.changeState('confirmSignIn', user);\n                } else if (user.challengeName === 'NEW_PASSWORD_REQUIRED') {\n                    logger.debug('require new password', user.challengeParam);\n                    _this3.changeState('requireNewPassword', user);\n                } else if (user.challengeName === 'MFA_SETUP') {\n                    logger.debug('TOTP setup', user.challengeParam);\n                    _this3.changeState('TOTPSetup', user);\n                } else {\n                    _this3.checkContact(user);\n                }\n            }).catch(function (err) {\n                if (err.code === 'UserNotConfirmedException') {\n                    logger.debug('the user is not confirmed');\n                    _this3.changeState('confirmSignUp');\n                } else {\n                    _this3.error(err);\n                }\n            });\n        }\n    }, {\n        key: 'showComponent',\n        value: function showComponent(theme) {\n            var _this4 = this;\n\n            var _props = this.props,\n                authState = _props.authState,\n                hide = _props.hide,\n                federated = _props.federated,\n                onStateChange = _props.onStateChange;\n\n            if (hide && hide.includes(SignIn)) {\n                return null;\n            }\n\n            return _react2.default.createElement(\n                _AmplifyUI.FormSection,\n                { theme: theme },\n                _react2.default.createElement(\n                    _AmplifyUI.SectionHeader,\n                    { theme: theme },\n                    _core.I18n.get('Sign In Account')\n                ),\n                _react2.default.createElement(\n                    _AmplifyUI.SectionBody,\n                    { theme: theme },\n                    _react2.default.createElement(_AmplifyUI.InputRow, {\n                        autoFocus: true,\n                        placeholder: _core.I18n.get('Username'),\n                        theme: theme,\n                        key: 'username',\n                        name: 'username',\n                        onChange: this.handleInputChange\n                    }),\n                    _react2.default.createElement(_AmplifyUI.InputRow, {\n                        placeholder: _core.I18n.get('Password'),\n                        theme: theme,\n                        key: 'password',\n                        type: 'password',\n                        name: 'password',\n                        onChange: this.handleInputChange\n                    }),\n                    _react2.default.createElement(\n                        _AmplifyUI.ButtonRow,\n                        { theme: theme, onClick: this.signIn },\n                        _core.I18n.get('Sign In')\n                    ),\n                    _react2.default.createElement(_FederatedSignIn.FederatedButtons, {\n                        federated: federated,\n                        theme: theme,\n                        authState: authState,\n                        onStateChange: onStateChange\n                    })\n                ),\n                _react2.default.createElement(\n                    _AmplifyUI.SectionFooter,\n                    { theme: theme },\n                    _react2.default.createElement(\n                        'div',\n                        { style: theme.col6 },\n                        _react2.default.createElement(\n                            _AmplifyUI.Link,\n                            { theme: theme, onClick: function onClick() {\n                                    return _this4.changeState('forgotPassword');\n                                } },\n                            _core.I18n.get('Forgot Password')\n                        )\n                    ),\n                    _react2.default.createElement(\n                        'div',\n                        { style: Object.assign({ textAlign: 'right' }, theme.col6) },\n                        _react2.default.createElement(\n                            _AmplifyUI.Link,\n                            { theme: theme, onClick: function onClick() {\n                                    return _this4.changeState('signUp');\n                                } },\n                            _core.I18n.get('Sign Up')\n                        )\n                    )\n                )\n            );\n        }\n    }]);\n    return SignIn;\n}(_AuthPiece3.default);\n\nexports.default = SignIn;"]},"metadata":{},"sourceType":"script"}