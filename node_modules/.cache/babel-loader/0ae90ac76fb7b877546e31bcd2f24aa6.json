{"ast":null,"code":"var _jsxFileName = \"/home/ec2-user/environment/amazon-cognito-identity-management-workshop/website/src/auth/SignUp.js\";\n\n/*\n *   Copyright 2018 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\nimport React from 'react';\nimport { Auth } from 'aws-amplify';\nimport DynamicImage from '../components/DynamicImage';\nimport { withRouter } from 'react-router-dom';\nimport '../css/app.css';\n/**\n * Registration Page\n */\n\nclass SignUp extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      stage: 0,\n      email: '',\n      phone: '',\n      genre: '',\n      password: '',\n      confirm: '',\n      code: ''\n    };\n  }\n\n  async onSubmitForm(e) {\n    e.preventDefault();\n\n    try {\n      const params = {\n        username: this.state.email.replace(/[@.]/g, '|'),\n        password: this.state.password,\n        attributes: {\n          email: this.state.email,\n          phone_number: this.state.phone,\n          'custom:genre': this.state.genre\n        },\n        validationData: []\n      };\n      const data = await Auth.signUp(params);\n      console.log(data);\n      this.setState({\n        stage: 1\n      });\n    } catch (err) {\n      if (err === \"No userPool\") {\n        // User pool not defined in Amplify config file\n        console.error(\"User Pool not defined\");\n        alert(\"User Pool not defined. Amplify config must be updated with user pool config\");\n      } else if (err.message === \"User already exists\") {\n        // Setting state to allow user to proceed to enter verification code\n        this.setState({\n          stage: 1\n        });\n      } else {\n        if (err.message.indexOf(\"phone number format\") >= 0) {\n          err.message = \"Invalid phone number format. Must include country code. Example: +14252345678\";\n        }\n\n        alert(err.message);\n        console.error(\"Exception from Auth.signUp: \", err);\n        this.setState({\n          stage: 0,\n          email: '',\n          password: '',\n          confirm: ''\n        });\n      }\n    }\n  }\n\n  async onSubmitVerification(e) {\n    e.preventDefault();\n\n    try {\n      const data = await Auth.confirmSignUp(this.state.email.replace(/[@.]/g, '|'), this.state.code);\n      console.log(data); // Go to the sign in page\n\n      this.props.history.replace('/signin');\n    } catch (err) {\n      alert(err.message);\n      console.error(\"Exception from Auth.confirmSignUp: \", err);\n    }\n  }\n\n  onEmailChanged(e) {\n    this.setState({\n      email: e.target.value.toLowerCase()\n    });\n  }\n\n  onPhoneChanged(e) {\n    this.setState({\n      phone: e.target.value\n    });\n  }\n\n  onGenreChanged(e) {\n    this.setState({\n      genre: e.target.value.toLowerCase()\n    });\n  }\n\n  onPasswordChanged(e) {\n    this.setState({\n      password: e.target.value\n    });\n  }\n\n  onConfirmationChanged(e) {\n    this.setState({\n      confirm: e.target.value\n    });\n  }\n\n  onCodeChanged(e) {\n    this.setState({\n      code: e.target.value\n    });\n  }\n\n  isValidEmail(email) {\n    var re = /^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n    return re.test(String(email).toLowerCase());\n  }\n\n  renderSignUp() {\n    const isValidEmail = this.isValidEmail(this.state.email);\n    const isValidPassword = this.state.password.length > 1;\n    const isValidGenre = this.state.genre.length > 1;\n    const isValidConfirmation = isValidPassword && this.state.password === this.state.confirm;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"app\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"header\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(DynamicImage, {\n      src: \"/images/logo-reservation.png\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125,\n        columnNumber: 11\n      }\n    })), /*#__PURE__*/React.createElement(\"section\", {\n      className: \"form-wrap\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"h1\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 11\n      }\n    }, \"Register\"), /*#__PURE__*/React.createElement(\"form\", {\n      id: \"registrationForm\",\n      onSubmit: e => this.onSubmitForm(e),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 129,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      className: isValidEmail ? 'valid' : 'invalid',\n      type: \"email\",\n      placeholder: \"Email\",\n      value: this.state.email,\n      onChange: e => this.onEmailChanged(e),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 130,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(\"input\", {\n      className: \"valid\",\n      type: \"phone\",\n      placeholder: \"Phone\",\n      value: this.state.phone,\n      onChange: e => this.onPhoneChanged(e),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 131,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(\"input\", {\n      className: \"valid\",\n      type: \"Genre\",\n      placeholder: \"Genre\",\n      value: this.state.genre,\n      onChange: e => this.onGenreChanged(e),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(\"input\", {\n      className: isValidPassword ? 'valid' : 'invalid',\n      type: \"password\",\n      placeholder: \"Password\",\n      value: this.state.password,\n      onChange: e => this.onPasswordChanged(e),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(\"input\", {\n      className: isValidConfirmation ? 'valid' : 'invalid',\n      type: \"password\",\n      placeholder: \"Confirm Password\",\n      value: this.state.confirm,\n      onChange: e => this.onConfirmationChanged(e),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 134,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(\"input\", {\n      disabled: !(isValidEmail && isValidPassword && isValidConfirmation),\n      type: \"submit\",\n      value: \"Register\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 135,\n        columnNumber: 13\n      }\n    }))));\n  }\n\n  renderConfirm() {\n    const isValidEmail = this.isValidEmail(this.state.email);\n    const isValidCode = this.state.code.length === 6;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"app\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"header\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 148,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(DynamicImage, {\n      src: \"logo.png\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 149,\n        columnNumber: 11\n      }\n    })), /*#__PURE__*/React.createElement(\"section\", {\n      className: \"form-wrap\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 151,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"h1\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 152,\n        columnNumber: 11\n      }\n    }, \"Verify Email\"), /*#__PURE__*/React.createElement(\"form\", {\n      id: \"verifyForm\",\n      onSubmit: e => this.onSubmitVerification(e),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 153,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      className: isValidEmail ? 'valid' : 'invalid',\n      type: \"email\",\n      placeholder: \"Email\",\n      value: this.state.email,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 154,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(\"input\", {\n      className: isValidCode ? 'valid' : 'invalid',\n      type: \"text\",\n      placeholder: \"Verification Code\",\n      value: this.state.code,\n      onChange: e => this.onCodeChanged(e),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 155,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(\"input\", {\n      disabled: !(isValidCode && isValidEmail),\n      type: \"submit\",\n      value: \"Verify\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 156,\n        columnNumber: 13\n      }\n    }))));\n  }\n\n  render() {\n    switch (this.state.stage) {\n      case 0:\n      default:\n        return this.renderSignUp();\n\n      case 1:\n        return this.renderConfirm();\n    }\n  }\n\n}\n\nexport default withRouter(SignUp);","map":{"version":3,"sources":["/home/ec2-user/environment/amazon-cognito-identity-management-workshop/website/src/auth/SignUp.js"],"names":["React","Auth","DynamicImage","withRouter","SignUp","Component","constructor","props","state","stage","email","phone","genre","password","confirm","code","onSubmitForm","e","preventDefault","params","username","replace","attributes","phone_number","validationData","data","signUp","console","log","setState","err","error","alert","message","indexOf","onSubmitVerification","confirmSignUp","history","onEmailChanged","target","value","toLowerCase","onPhoneChanged","onGenreChanged","onPasswordChanged","onConfirmationChanged","onCodeChanged","isValidEmail","re","test","String","renderSignUp","isValidPassword","length","isValidGenre","isValidConfirmation","renderConfirm","isValidCode","render"],"mappings":"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","sourcesContent":["/*\n *   Copyright 2018 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\nimport React from 'react';\nimport { Auth } from 'aws-amplify';\nimport DynamicImage from '../components/DynamicImage';\nimport { withRouter } from 'react-router-dom';\n\nimport '../css/app.css';\n\n/**\n * Registration Page\n */\nclass SignUp extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      stage: 0,\n      email: '',\n      phone: '',\n      genre: '',\n      password: '',\n      confirm: '',\n      code: ''\n    };\n  }\n\nasync onSubmitForm(e) {\n    e.preventDefault();\n    try {\n        const params = {\n            username: this.state.email.replace(/[@.]/g, '|'),\n            password: this.state.password,\n            attributes: {\n                email: this.state.email,\n                phone_number: this.state.phone,\n                'custom:genre': this.state.genre\n            },\n            validationData: []\n        };\n        const data = await Auth.signUp(params);\n        console.log(data);\n        this.setState({ stage: 1 });\n    } catch (err) {\n    if (err === \"No userPool\") {\n        // User pool not defined in Amplify config file\n        console.error(\"User Pool not defined\");\n        alert(\"User Pool not defined. Amplify config must be updated with user pool config\");\n    } else if (err.message === \"User already exists\") {\n        // Setting state to allow user to proceed to enter verification code\n        this.setState({ stage: 1 });\n    } else {\n        if (err.message.indexOf(\"phone number format\") >= 0) {err.message = \"Invalid phone number format. Must include country code. Example: +14252345678\"}\n        alert(err.message);\n        console.error(\"Exception from Auth.signUp: \", err);\n        this.setState({ stage: 0, email: '', password: '', confirm: '' });\n    }\n    }\n}\n\nasync onSubmitVerification(e) {\n    e.preventDefault();\n    try {\n        const data = await Auth.confirmSignUp(\n            this.state.email.replace(/[@.]/g, '|'),\n            this.state.code\n        );\n        console.log(data);\n        // Go to the sign in page\n        this.props.history.replace('/signin');\n    } catch (err) {\n        alert(err.message);\n        console.error(\"Exception from Auth.confirmSignUp: \", err);\n    }\n}\n  onEmailChanged(e) {\n    this.setState({ email: e.target.value.toLowerCase() });\n  }\n\n  onPhoneChanged(e) {\n    this.setState({ phone: e.target.value });\n  }\n  \n  onGenreChanged(e) {\n    this.setState({ genre: e.target.value.toLowerCase() });\n  }\n\n  onPasswordChanged(e) {\n    this.setState({ password: e.target.value });\n  }\n\n  onConfirmationChanged(e) {\n    this.setState({ confirm: e.target.value });\n  }\n\n  onCodeChanged(e) {\n    this.setState({ code: e.target.value });\n  }\n\n  isValidEmail(email) {\n    var re = /^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n    return re.test(String(email).toLowerCase());\n  }\n\n  renderSignUp() {\n    const isValidEmail = this.isValidEmail(this.state.email);\n    const isValidPassword = this.state.password.length > 1;\n    const isValidGenre = this.state.genre.length > 1;\n    const isValidConfirmation = isValidPassword && this.state.password === this.state.confirm;\n\n    return (\n      <div className=\"app\">\n        <header>\n          <DynamicImage src=\"/images/logo-reservation.png\"/>\n        </header>\n        <section className=\"form-wrap\">\n          <h1>Register</h1>\n          <form id=\"registrationForm\" onSubmit={(e) => this.onSubmitForm(e)}>\n            <input className={isValidEmail?'valid':'invalid'} type=\"email\" placeholder=\"Email\" value={this.state.email} onChange={(e) => this.onEmailChanged(e)}/>\n            <input className='valid' type=\"phone\" placeholder=\"Phone\" value={this.state.phone} onChange={(e) => this.onPhoneChanged(e)}/>\n            <input className='valid' type=\"Genre\" placeholder=\"Genre\" value={this.state.genre} onChange={(e) => this.onGenreChanged(e)}/>\n            <input className={isValidPassword?'valid':'invalid'} type=\"password\" placeholder=\"Password\" value={this.state.password} onChange={(e) => this.onPasswordChanged(e)}/>\n            <input className={isValidConfirmation?'valid':'invalid'} type=\"password\" placeholder=\"Confirm Password\" value={this.state.confirm} onChange={(e) => this.onConfirmationChanged(e)}/>\n            <input disabled={!(isValidEmail && isValidPassword && isValidConfirmation)} type=\"submit\" value=\"Register\"/>\n          </form>\n        </section>\n      </div>\n    );\n  }\n\n  renderConfirm() {\n    const isValidEmail = this.isValidEmail(this.state.email);\n    const isValidCode = this.state.code.length === 6;\n\n    return (\n      <div className=\"app\">\n        <header>\n          <DynamicImage src=\"logo.png\"/>\n        </header>\n        <section className=\"form-wrap\">\n          <h1>Verify Email</h1>\n          <form id=\"verifyForm\" onSubmit={(e) => this.onSubmitVerification(e)}>\n            <input className={isValidEmail?'valid':'invalid'} type=\"email\" placeholder=\"Email\" value={this.state.email}/>\n            <input className={isValidCode?'valid':'invalid'} type=\"text\" placeholder=\"Verification Code\" value={this.state.code} onChange={(e) => this.onCodeChanged(e)}/>\n            <input disabled={!(isValidCode&&isValidEmail)} type=\"submit\" value=\"Verify\"/>\n          </form>\n        </section>\n      </div>\n    );\n  }\n\n  render() {\n    switch (this.state.stage) {\n      case 0:\n      default:\n        return this.renderSignUp();\n      case 1:\n        return this.renderConfirm();\n    }\n  }\n}\n\nexport default withRouter(SignUp);\n"]},"metadata":{},"sourceType":"module"}