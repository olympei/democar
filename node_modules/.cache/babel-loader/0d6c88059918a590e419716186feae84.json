{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _regenerator = require('babel-runtime/regenerator');\n\nvar _regenerator2 = _interopRequireDefault(_regenerator);\n\nvar _asyncToGenerator2 = require('babel-runtime/helpers/asyncToGenerator');\n\nvar _asyncToGenerator3 = _interopRequireDefault(_asyncToGenerator2);\n\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = require('babel-runtime/helpers/createClass');\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require('babel-runtime/helpers/inherits');\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nvar _runtime = require('regenerator-runtime/runtime');\n\nvar _runtime2 = _interopRequireDefault(_runtime);\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _api = require('@aws-amplify/api');\n\nvar _api2 = _interopRequireDefault(_api);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nvar Connect = function (_Component) {\n  (0, _inherits3.default)(Connect, _Component);\n\n  function Connect(props) {\n    (0, _classCallCheck3.default)(this, Connect);\n\n    var _this = (0, _possibleConstructorReturn3.default)(this, (Connect.__proto__ || Object.getPrototypeOf(Connect)).call(this, props));\n\n    _this.state = _this.getDefaultState();\n    _this.subSubscription = null;\n    return _this;\n  }\n\n  (0, _createClass3.default)(Connect, [{\n    key: 'getDefaultState',\n    value: function getDefaultState() {\n      return {\n        loading: false,\n        data: {},\n        errors: [],\n        mutation: function mutation() {\n          return console.warn('Not implemented');\n        }\n      };\n    }\n  }, {\n    key: '_fetchData',\n    value: function () {\n      var _ref = (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee2() {\n        var _this2 = this;\n\n        var _props, _props$query, query, _props$query$variable, variables, _props$mutation, mutation, _props$mutation$mutat, mutationVariables, subscription, _props$onSubscription, onSubscriptionMsg, _getDefaultState, data, mutationProp, errors, hasValidQuery, hasValidMutation, hasValidSubscription, response, subsQuery, subsVars, observable;\n\n        return _regenerator2.default.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                this._unsubscribe();\n\n                this.setState({\n                  loading: true\n                });\n                _props = this.props, _props$query = _props.query;\n                _props$query = _props$query === undefined ? {} : _props$query;\n                query = _props$query.query, _props$query$variable = _props$query.variables, variables = _props$query$variable === undefined ? {} : _props$query$variable, _props$mutation = _props.mutation;\n                _props$mutation = _props$mutation === undefined ? {} : _props$mutation;\n                mutation = _props$mutation.query, _props$mutation$mutat = _props$mutation.mutationVariables, mutationVariables = _props$mutation$mutat === undefined ? {} : _props$mutation$mutat, subscription = _props.subscription, _props$onSubscription = _props.onSubscriptionMsg, onSubscriptionMsg = _props$onSubscription === undefined ? function (prevData) {\n                  return prevData;\n                } : _props$onSubscription;\n                _getDefaultState = this.getDefaultState(), data = _getDefaultState.data, mutationProp = _getDefaultState.mutation, errors = _getDefaultState.errors;\n\n                if (!(!_api2.default || typeof _api2.default.graphql !== 'function' || typeof _api2.default.getGraphqlOperationType !== 'function')) {\n                  _context2.next = 10;\n                  break;\n                }\n\n                throw new Error('No API module found, please ensure @aws-amplify/api is imported');\n\n              case 10:\n                hasValidQuery = query && _api2.default.getGraphqlOperationType(query) === 'query';\n                hasValidMutation = mutation && _api2.default.getGraphqlOperationType(mutation) === 'mutation';\n                hasValidSubscription = subscription && _api2.default.getGraphqlOperationType(subscription.query) === 'subscription';\n\n                if (!hasValidQuery && !hasValidMutation && !hasValidSubscription) {\n                  console.warn('No query, mutation or subscription was specified');\n                }\n\n                if (!hasValidQuery) {\n                  _context2.next = 27;\n                  break;\n                }\n\n                _context2.prev = 15;\n                data = null;\n                _context2.next = 19;\n                return _api2.default.graphql({\n                  query: query,\n                  variables: variables\n                });\n\n              case 19:\n                response = _context2.sent;\n                data = response.data;\n                _context2.next = 27;\n                break;\n\n              case 23:\n                _context2.prev = 23;\n                _context2.t0 = _context2['catch'](15);\n                data = _context2.t0.data;\n                errors = _context2.t0.errors;\n\n              case 27:\n                if (hasValidMutation) {\n                  mutationProp = function () {\n                    var _ref2 = (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee(variables) {\n                      var result;\n                      return _regenerator2.default.wrap(function _callee$(_context) {\n                        while (1) {\n                          switch (_context.prev = _context.next) {\n                            case 0:\n                              _context.next = 2;\n                              return _api2.default.graphql({\n                                query: mutation,\n                                variables: variables\n                              });\n\n                            case 2:\n                              result = _context.sent;\n\n                              _this2.forceUpdate();\n\n                              return _context.abrupt('return', result);\n\n                            case 5:\n                            case 'end':\n                              return _context.stop();\n                          }\n                        }\n                      }, _callee, _this2);\n                    }));\n\n                    return function mutationProp(_x) {\n                      return _ref2.apply(this, arguments);\n                    };\n                  }();\n                }\n\n                if (hasValidSubscription) {\n                  subsQuery = subscription.query, subsVars = subscription.variables;\n\n                  try {\n                    observable = _api2.default.graphql({\n                      query: subsQuery,\n                      variables: subsVars\n                    });\n                    this.subSubscription = observable.subscribe({\n                      next: function next(_ref3) {\n                        var data = _ref3.value.data;\n                        var prevData = _this2.state.data;\n                        var newData = onSubscriptionMsg(prevData, data);\n\n                        _this2.setState({\n                          data: newData\n                        });\n                      },\n                      error: function error(err) {\n                        return console.error(err);\n                      }\n                    });\n                  } catch (err) {\n                    errors = err.errors;\n                  }\n                }\n\n                this.setState({\n                  data: data,\n                  errors: errors,\n                  mutation: mutationProp,\n                  loading: false\n                });\n\n              case 30:\n              case 'end':\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this, [[15, 23]]);\n      }));\n\n      function _fetchData() {\n        return _ref.apply(this, arguments);\n      }\n\n      return _fetchData;\n    }()\n  }, {\n    key: '_unsubscribe',\n    value: function _unsubscribe() {\n      if (this.subSubscription) {\n        this.subSubscription.unsubscribe();\n      }\n\n      ;\n    }\n  }, {\n    key: 'componentDidMount',\n    value: function () {\n      var _ref4 = (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee3() {\n        return _regenerator2.default.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                this._fetchData();\n\n              case 1:\n              case 'end':\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function componentDidMount() {\n        return _ref4.apply(this, arguments);\n      }\n\n      return componentDidMount;\n    }()\n  }, {\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      this._unsubscribe();\n    }\n  }, {\n    key: 'componentDidUpdate',\n    value: function componentDidUpdate(prevProps) {\n      var loading = this.state.loading;\n      var _props2 = this.props,\n          newQueryObj = _props2.query,\n          newMutationObj = _props2.mutation;\n      var prevQueryObj = prevProps.query,\n          prevMutationObj = prevProps.mutation; // query\n\n      var _ref5 = newQueryObj || {},\n          newQuery = _ref5.query,\n          newQueryVariables = _ref5.variables;\n\n      var _ref6 = prevQueryObj || {},\n          prevQuery = _ref6.query,\n          prevQueryVariables = _ref6.variables;\n\n      var queryChanged = prevQuery !== newQuery || JSON.stringify(prevQueryVariables) !== JSON.stringify(newQueryVariables); // mutation\n\n      var _ref7 = newMutationObj || {},\n          newMutation = _ref7.query,\n          newMutationVariables = _ref7.variables;\n\n      var _ref8 = prevMutationObj || {},\n          prevMutation = _ref8.query,\n          prevMutationVariables = _ref8.variables;\n\n      var mutationChanged = prevMutation !== newMutation || JSON.stringify(prevMutationVariables) !== JSON.stringify(newMutationVariables);\n\n      if (!loading && (queryChanged || mutationChanged)) {\n        this._fetchData();\n      }\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _state = this.state,\n          data = _state.data,\n          loading = _state.loading,\n          mutation = _state.mutation,\n          errors = _state.errors;\n      return this.props.children({\n        data: data,\n        errors: errors,\n        loading: loading,\n        mutation: mutation\n      }) || null;\n    }\n  }]);\n  return Connect;\n}(_react.Component);\n\nexports.default = Connect;","map":{"version":3,"sources":["/home/ec2-user/environment/amazon-cognito-identity-management-workshop/website/node_modules/aws-amplify-react/dist/API/GraphQL/Connect.js"],"names":["Object","defineProperty","exports","value","_regenerator","require","_regenerator2","_interopRequireDefault","_asyncToGenerator2","_asyncToGenerator3","_classCallCheck2","_classCallCheck3","_createClass2","_createClass3","_possibleConstructorReturn2","_possibleConstructorReturn3","_inherits2","_inherits3","_runtime","_runtime2","_react","_react2","_api","_api2","obj","__esModule","default","Connect","_Component","props","_this","__proto__","getPrototypeOf","call","state","getDefaultState","subSubscription","key","loading","data","errors","mutation","console","warn","_ref","mark","_callee2","_this2","_props","_props$query","query","_props$query$variable","variables","_props$mutation","_props$mutation$mutat","mutationVariables","subscription","_props$onSubscription","onSubscriptionMsg","_getDefaultState","mutationProp","hasValidQuery","hasValidMutation","hasValidSubscription","response","subsQuery","subsVars","observable","wrap","_callee2$","_context2","prev","next","_unsubscribe","setState","undefined","prevData","graphql","getGraphqlOperationType","Error","sent","t0","_ref2","_callee","result","_callee$","_context","forceUpdate","abrupt","stop","_x","apply","arguments","subscribe","_ref3","newData","error","err","_fetchData","unsubscribe","_ref4","_callee3","_callee3$","_context3","componentDidMount","componentWillUnmount","componentDidUpdate","prevProps","_props2","newQueryObj","newMutationObj","prevQueryObj","prevMutationObj","_ref5","newQuery","newQueryVariables","_ref6","prevQuery","prevQueryVariables","queryChanged","JSON","stringify","_ref7","newMutation","newMutationVariables","_ref8","prevMutation","prevMutationVariables","mutationChanged","render","_state","children","Component"],"mappings":"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","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _regenerator = require('babel-runtime/regenerator');\n\nvar _regenerator2 = _interopRequireDefault(_regenerator);\n\nvar _asyncToGenerator2 = require('babel-runtime/helpers/asyncToGenerator');\n\nvar _asyncToGenerator3 = _interopRequireDefault(_asyncToGenerator2);\n\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = require('babel-runtime/helpers/createClass');\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require('babel-runtime/helpers/inherits');\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nvar _runtime = require('regenerator-runtime/runtime');\n\nvar _runtime2 = _interopRequireDefault(_runtime);\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _api = require('@aws-amplify/api');\n\nvar _api2 = _interopRequireDefault(_api);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar Connect = function (_Component) {\n    (0, _inherits3.default)(Connect, _Component);\n\n    function Connect(props) {\n        (0, _classCallCheck3.default)(this, Connect);\n\n        var _this = (0, _possibleConstructorReturn3.default)(this, (Connect.__proto__ || Object.getPrototypeOf(Connect)).call(this, props));\n\n        _this.state = _this.getDefaultState();\n        _this.subSubscription = null;\n        return _this;\n    }\n\n    (0, _createClass3.default)(Connect, [{\n        key: 'getDefaultState',\n        value: function getDefaultState() {\n            return {\n                loading: false,\n                data: {},\n                errors: [],\n                mutation: function mutation() {\n                    return console.warn('Not implemented');\n                }\n            };\n        }\n    }, {\n        key: '_fetchData',\n        value: function () {\n            var _ref = (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee2() {\n                var _this2 = this;\n\n                var _props, _props$query, query, _props$query$variable, variables, _props$mutation, mutation, _props$mutation$mutat, mutationVariables, subscription, _props$onSubscription, onSubscriptionMsg, _getDefaultState, data, mutationProp, errors, hasValidQuery, hasValidMutation, hasValidSubscription, response, subsQuery, subsVars, observable;\n\n                return _regenerator2.default.wrap(function _callee2$(_context2) {\n                    while (1) {\n                        switch (_context2.prev = _context2.next) {\n                            case 0:\n                                this._unsubscribe();\n                                this.setState({ loading: true });\n\n                                _props = this.props, _props$query = _props.query;\n                                _props$query = _props$query === undefined ? {} : _props$query;\n                                query = _props$query.query, _props$query$variable = _props$query.variables, variables = _props$query$variable === undefined ? {} : _props$query$variable, _props$mutation = _props.mutation;\n                                _props$mutation = _props$mutation === undefined ? {} : _props$mutation;\n                                mutation = _props$mutation.query, _props$mutation$mutat = _props$mutation.mutationVariables, mutationVariables = _props$mutation$mutat === undefined ? {} : _props$mutation$mutat, subscription = _props.subscription, _props$onSubscription = _props.onSubscriptionMsg, onSubscriptionMsg = _props$onSubscription === undefined ? function (prevData) {\n                                    return prevData;\n                                } : _props$onSubscription;\n                                _getDefaultState = this.getDefaultState(), data = _getDefaultState.data, mutationProp = _getDefaultState.mutation, errors = _getDefaultState.errors;\n\n                                if (!(!_api2.default || typeof _api2.default.graphql !== 'function' || typeof _api2.default.getGraphqlOperationType !== 'function')) {\n                                    _context2.next = 10;\n                                    break;\n                                }\n\n                                throw new Error('No API module found, please ensure @aws-amplify/api is imported');\n\n                            case 10:\n                                hasValidQuery = query && _api2.default.getGraphqlOperationType(query) === 'query';\n                                hasValidMutation = mutation && _api2.default.getGraphqlOperationType(mutation) === 'mutation';\n                                hasValidSubscription = subscription && _api2.default.getGraphqlOperationType(subscription.query) === 'subscription';\n\n\n                                if (!hasValidQuery && !hasValidMutation && !hasValidSubscription) {\n                                    console.warn('No query, mutation or subscription was specified');\n                                }\n\n                                if (!hasValidQuery) {\n                                    _context2.next = 27;\n                                    break;\n                                }\n\n                                _context2.prev = 15;\n\n                                data = null;\n\n                                _context2.next = 19;\n                                return _api2.default.graphql({ query: query, variables: variables });\n\n                            case 19:\n                                response = _context2.sent;\n\n\n                                data = response.data;\n                                _context2.next = 27;\n                                break;\n\n                            case 23:\n                                _context2.prev = 23;\n                                _context2.t0 = _context2['catch'](15);\n\n                                data = _context2.t0.data;\n                                errors = _context2.t0.errors;\n\n                            case 27:\n\n                                if (hasValidMutation) {\n                                    mutationProp = function () {\n                                        var _ref2 = (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee(variables) {\n                                            var result;\n                                            return _regenerator2.default.wrap(function _callee$(_context) {\n                                                while (1) {\n                                                    switch (_context.prev = _context.next) {\n                                                        case 0:\n                                                            _context.next = 2;\n                                                            return _api2.default.graphql({ query: mutation, variables: variables });\n\n                                                        case 2:\n                                                            result = _context.sent;\n\n\n                                                            _this2.forceUpdate();\n                                                            return _context.abrupt('return', result);\n\n                                                        case 5:\n                                                        case 'end':\n                                                            return _context.stop();\n                                                    }\n                                                }\n                                            }, _callee, _this2);\n                                        }));\n\n                                        return function mutationProp(_x) {\n                                            return _ref2.apply(this, arguments);\n                                        };\n                                    }();\n                                }\n\n                                if (hasValidSubscription) {\n                                    subsQuery = subscription.query, subsVars = subscription.variables;\n\n\n                                    try {\n                                        observable = _api2.default.graphql({ query: subsQuery, variables: subsVars });\n\n\n                                        this.subSubscription = observable.subscribe({\n                                            next: function next(_ref3) {\n                                                var data = _ref3.value.data;\n                                                var prevData = _this2.state.data;\n\n                                                var newData = onSubscriptionMsg(prevData, data);\n                                                _this2.setState({ data: newData });\n                                            },\n                                            error: function error(err) {\n                                                return console.error(err);\n                                            }\n                                        });\n                                    } catch (err) {\n                                        errors = err.errors;\n                                    }\n                                }\n\n                                this.setState({ data: data, errors: errors, mutation: mutationProp, loading: false });\n\n                            case 30:\n                            case 'end':\n                                return _context2.stop();\n                        }\n                    }\n                }, _callee2, this, [[15, 23]]);\n            }));\n\n            function _fetchData() {\n                return _ref.apply(this, arguments);\n            }\n\n            return _fetchData;\n        }()\n    }, {\n        key: '_unsubscribe',\n        value: function _unsubscribe() {\n            if (this.subSubscription) {\n                this.subSubscription.unsubscribe();\n            };\n        }\n    }, {\n        key: 'componentDidMount',\n        value: function () {\n            var _ref4 = (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee3() {\n                return _regenerator2.default.wrap(function _callee3$(_context3) {\n                    while (1) {\n                        switch (_context3.prev = _context3.next) {\n                            case 0:\n                                this._fetchData();\n\n                            case 1:\n                            case 'end':\n                                return _context3.stop();\n                        }\n                    }\n                }, _callee3, this);\n            }));\n\n            function componentDidMount() {\n                return _ref4.apply(this, arguments);\n            }\n\n            return componentDidMount;\n        }()\n    }, {\n        key: 'componentWillUnmount',\n        value: function componentWillUnmount() {\n            this._unsubscribe();\n        }\n    }, {\n        key: 'componentDidUpdate',\n        value: function componentDidUpdate(prevProps) {\n            var loading = this.state.loading;\n            var _props2 = this.props,\n                newQueryObj = _props2.query,\n                newMutationObj = _props2.mutation;\n            var prevQueryObj = prevProps.query,\n                prevMutationObj = prevProps.mutation;\n\n            // query\n\n            var _ref5 = newQueryObj || {},\n                newQuery = _ref5.query,\n                newQueryVariables = _ref5.variables;\n\n            var _ref6 = prevQueryObj || {},\n                prevQuery = _ref6.query,\n                prevQueryVariables = _ref6.variables;\n\n            var queryChanged = prevQuery !== newQuery || JSON.stringify(prevQueryVariables) !== JSON.stringify(newQueryVariables);\n\n            // mutation\n\n            var _ref7 = newMutationObj || {},\n                newMutation = _ref7.query,\n                newMutationVariables = _ref7.variables;\n\n            var _ref8 = prevMutationObj || {},\n                prevMutation = _ref8.query,\n                prevMutationVariables = _ref8.variables;\n\n            var mutationChanged = prevMutation !== newMutation || JSON.stringify(prevMutationVariables) !== JSON.stringify(newMutationVariables);\n\n            if (!loading && (queryChanged || mutationChanged)) {\n                this._fetchData();\n            }\n        }\n    }, {\n        key: 'render',\n        value: function render() {\n            var _state = this.state,\n                data = _state.data,\n                loading = _state.loading,\n                mutation = _state.mutation,\n                errors = _state.errors;\n\n\n            return this.props.children({ data: data, errors: errors, loading: loading, mutation: mutation }) || null;\n        }\n    }]);\n    return Connect;\n}(_react.Component);\n\nexports.default = Connect;"]},"metadata":{},"sourceType":"script"}