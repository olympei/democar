{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = require('babel-runtime/helpers/createClass');\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require('babel-runtime/helpers/inherits');\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _core = require('@aws-amplify/core');\n\nvar _storage = require('@aws-amplify/storage');\n\nvar _storage2 = _interopRequireDefault(_storage);\n\nvar _AmplifyTheme = require('../AmplifyTheme');\n\nvar _AmplifyTheme2 = _interopRequireDefault(_AmplifyTheme);\n\nvar _Widget = require('../Widget');\n\nvar _Common = require('./Common');\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n/*\n * Copyright 2017-2017 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *     http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\n\n\nvar logger = new _core.ConsoleLogger('Storage.S3Text');\n\nvar S3Text = function (_Component) {\n  (0, _inherits3.default)(S3Text, _Component);\n\n  function S3Text(props) {\n    (0, _classCallCheck3.default)(this, S3Text);\n\n    var _this = (0, _possibleConstructorReturn3.default)(this, (S3Text.__proto__ || Object.getPrototypeOf(S3Text)).call(this, props));\n\n    _this.handleOnLoad = _this.handleOnLoad.bind(_this);\n    _this.handleOnError = _this.handleOnError.bind(_this);\n    _this.handlePick = _this.handlePick.bind(_this);\n    _this.handleClick = _this.handleClick.bind(_this);\n    var text = props.text,\n        textKey = props.textKey;\n    _this.state = {\n      text: text || '',\n      textKey: textKey || ''\n    };\n    return _this;\n  }\n\n  (0, _createClass3.default)(S3Text, [{\n    key: 'getText',\n    value: function getText(key, level, track) {\n      var _this2 = this;\n\n      if (!_storage2.default || typeof _storage2.default.get !== 'function') {\n        throw new Error('No Storage module found, please ensure @aws-amplify/storage is imported');\n      }\n\n      _storage2.default.get(key, {\n        download: true,\n        level: level ? level : 'public',\n        track: track\n      }).then(function (data) {\n        logger.debug(data);\n        var text = data.Body.toString('utf8');\n\n        _this2.setState({\n          text: text\n        });\n\n        _this2.handleOnLoad(text);\n      }).catch(function (err) {\n        logger.debug(err);\n\n        _this2.handleOnError(err);\n      });\n    }\n  }, {\n    key: 'load',\n    value: function load() {\n      var _props = this.props,\n          path = _props.path,\n          textKey = _props.textKey,\n          body = _props.body,\n          contentType = _props.contentType,\n          level = _props.level,\n          track = _props.track;\n\n      if (!textKey && !path) {\n        logger.debug('empty textKey and path');\n        return;\n      }\n\n      var that = this;\n      var key = textKey || path;\n      logger.debug('loading ' + key + '...');\n\n      if (body) {\n        var type = contentType || 'text/*';\n\n        if (!_storage2.default || typeof _storage2.default.put !== 'function') {\n          throw new Error('No Storage module found, please ensure @aws-amplify/storage is imported');\n        }\n\n        var ret = _storage2.default.put(key, body, {\n          contentType: type,\n          level: level ? level : 'public',\n          track: track\n        });\n\n        ret.then(function (data) {\n          logger.debug(data);\n          that.getText(key, level, track);\n        }).catch(function (err) {\n          return logger.debug(err);\n        });\n      } else {\n        that.getText(key, level, track);\n      }\n    }\n  }, {\n    key: 'handleOnLoad',\n    value: function handleOnLoad(text) {\n      var onLoad = this.props.onLoad;\n\n      if (onLoad) {\n        onLoad(text);\n      }\n    }\n  }, {\n    key: 'handleOnError',\n    value: function handleOnError(err) {\n      var onError = this.props.onError;\n\n      if (onError) {\n        onError(err);\n      }\n    }\n  }, {\n    key: 'handlePick',\n    value: function handlePick(data) {\n      var that = this;\n      var path = this.props.path || '';\n      var _props2 = this.props,\n          textKey = _props2.textKey,\n          level = _props2.level,\n          fileToKey = _props2.fileToKey,\n          track = _props2.track;\n      var file = data.file,\n          name = data.name,\n          size = data.size,\n          type = data.type;\n      var key = textKey || path + (0, _Common.calcKey)(data, fileToKey);\n\n      if (!_storage2.default || typeof _storage2.default.put !== 'function') {\n        throw new Error('No Storage module found, please ensure @aws-amplify/storage is imported');\n      }\n\n      _storage2.default.put(key, file, {\n        level: level ? level : 'public',\n        contentType: type,\n        track: track\n      }).then(function (data) {\n        logger.debug('handle pick data', data);\n        that.getText(key, level, track);\n      }).catch(function (err) {\n        return logger.debug('handle pick error', err);\n      });\n    }\n  }, {\n    key: 'handleClick',\n    value: function handleClick(evt) {\n      var onClick = this.props.onClick;\n\n      if (onClick) {\n        onClick(evt);\n      }\n    }\n  }, {\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      this.load();\n    }\n  }, {\n    key: 'componentDidUpdate',\n    value: function componentDidUpdate(prevProps) {\n      var update = prevProps.path !== this.props.path || prevProps.textKey !== this.props.textKey || prevProps.body !== this.props.body;\n\n      if (update) {\n        this.load();\n      }\n    }\n  }, {\n    key: 'textEl',\n    value: function textEl(text, theme) {\n      if (!text) {\n        return null;\n      }\n\n      var selected = this.props.selected;\n      var containerStyle = {\n        position: 'relative'\n      };\n      return _react2.default.createElement('div', {\n        style: containerStyle,\n        onClick: this.handleClick\n      }, _react2.default.createElement('pre', {\n        style: theme.pre\n      }, text), _react2.default.createElement('div', {\n        style: selected ? theme.overlaySelected : theme.overlay\n      }));\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _props3 = this.props,\n          hidden = _props3.hidden,\n          style = _props3.style,\n          picker = _props3.picker,\n          translate = _props3.translate,\n          textKey = _props3.textKey;\n      var text = this.state.text;\n\n      if (translate) {\n        text = typeof translate === 'string' ? translate : translate({\n          type: 'text',\n          key: textKey,\n          content: text\n        });\n      }\n\n      if (!text && !picker) {\n        return null;\n      }\n\n      var theme = this.props.theme || _AmplifyTheme2.default;\n      var textStyle = hidden ? _AmplifyTheme2.default.hidden : Object.assign({}, theme.text, style);\n      return _react2.default.createElement('div', {\n        style: textStyle\n      }, textStyle ? this.textEl(text, theme) : null, picker ? _react2.default.createElement('div', null, _react2.default.createElement(_Widget.TextPicker, {\n        key: 'picker',\n        onPick: this.handlePick,\n        theme: theme\n      })) : null);\n    }\n  }]);\n  return S3Text;\n}(_react.Component);\n\nexports.default = S3Text;","map":{"version":3,"sources":["/home/ec2-user/environment/amazon-cognito-identity-management-workshop/website/node_modules/aws-amplify-react/dist/Storage/S3Text.js"],"names":["Object","defineProperty","exports","value","_classCallCheck2","require","_classCallCheck3","_interopRequireDefault","_createClass2","_createClass3","_possibleConstructorReturn2","_possibleConstructorReturn3","_inherits2","_inherits3","_react","_react2","_core","_storage","_storage2","_AmplifyTheme","_AmplifyTheme2","_Widget","_Common","obj","__esModule","default","logger","ConsoleLogger","S3Text","_Component","props","_this","__proto__","getPrototypeOf","call","handleOnLoad","bind","handleOnError","handlePick","handleClick","text","textKey","state","key","getText","level","track","_this2","get","Error","download","then","data","debug","Body","toString","setState","catch","err","load","_props","path","body","contentType","that","type","put","ret","onLoad","onError","_props2","fileToKey","file","name","size","calcKey","evt","onClick","componentDidMount","componentDidUpdate","prevProps","update","textEl","theme","selected","containerStyle","position","createElement","style","pre","overlaySelected","overlay","render","_props3","hidden","picker","translate","content","textStyle","assign","TextPicker","onPick","Component"],"mappings":"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","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = require('babel-runtime/helpers/createClass');\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require('babel-runtime/helpers/inherits');\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _core = require('@aws-amplify/core');\n\nvar _storage = require('@aws-amplify/storage');\n\nvar _storage2 = _interopRequireDefault(_storage);\n\nvar _AmplifyTheme = require('../AmplifyTheme');\n\nvar _AmplifyTheme2 = _interopRequireDefault(_AmplifyTheme);\n\nvar _Widget = require('../Widget');\n\nvar _Common = require('./Common');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/*\n * Copyright 2017-2017 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *     http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\n\nvar logger = new _core.ConsoleLogger('Storage.S3Text');\n\nvar S3Text = function (_Component) {\n    (0, _inherits3.default)(S3Text, _Component);\n\n    function S3Text(props) {\n        (0, _classCallCheck3.default)(this, S3Text);\n\n        var _this = (0, _possibleConstructorReturn3.default)(this, (S3Text.__proto__ || Object.getPrototypeOf(S3Text)).call(this, props));\n\n        _this.handleOnLoad = _this.handleOnLoad.bind(_this);\n        _this.handleOnError = _this.handleOnError.bind(_this);\n        _this.handlePick = _this.handlePick.bind(_this);\n        _this.handleClick = _this.handleClick.bind(_this);\n\n        var text = props.text,\n            textKey = props.textKey;\n\n        _this.state = {\n            text: text || '',\n            textKey: textKey || ''\n        };\n        return _this;\n    }\n\n    (0, _createClass3.default)(S3Text, [{\n        key: 'getText',\n        value: function getText(key, level, track) {\n            var _this2 = this;\n\n            if (!_storage2.default || typeof _storage2.default.get !== 'function') {\n                throw new Error('No Storage module found, please ensure @aws-amplify/storage is imported');\n            }\n            _storage2.default.get(key, { download: true, level: level ? level : 'public', track: track }).then(function (data) {\n                logger.debug(data);\n                var text = data.Body.toString('utf8');\n                _this2.setState({ text: text });\n                _this2.handleOnLoad(text);\n            }).catch(function (err) {\n                logger.debug(err);\n                _this2.handleOnError(err);\n            });\n        }\n    }, {\n        key: 'load',\n        value: function load() {\n            var _props = this.props,\n                path = _props.path,\n                textKey = _props.textKey,\n                body = _props.body,\n                contentType = _props.contentType,\n                level = _props.level,\n                track = _props.track;\n\n            if (!textKey && !path) {\n                logger.debug('empty textKey and path');\n                return;\n            }\n\n            var that = this;\n            var key = textKey || path;\n            logger.debug('loading ' + key + '...');\n            if (body) {\n                var type = contentType || 'text/*';\n                if (!_storage2.default || typeof _storage2.default.put !== 'function') {\n                    throw new Error('No Storage module found, please ensure @aws-amplify/storage is imported');\n                }\n                var ret = _storage2.default.put(key, body, {\n                    contentType: type,\n                    level: level ? level : 'public',\n                    track: track\n                });\n                ret.then(function (data) {\n                    logger.debug(data);\n                    that.getText(key, level, track);\n                }).catch(function (err) {\n                    return logger.debug(err);\n                });\n            } else {\n                that.getText(key, level, track);\n            }\n        }\n    }, {\n        key: 'handleOnLoad',\n        value: function handleOnLoad(text) {\n            var onLoad = this.props.onLoad;\n\n            if (onLoad) {\n                onLoad(text);\n            }\n        }\n    }, {\n        key: 'handleOnError',\n        value: function handleOnError(err) {\n            var onError = this.props.onError;\n\n            if (onError) {\n                onError(err);\n            }\n        }\n    }, {\n        key: 'handlePick',\n        value: function handlePick(data) {\n            var that = this;\n\n            var path = this.props.path || '';\n            var _props2 = this.props,\n                textKey = _props2.textKey,\n                level = _props2.level,\n                fileToKey = _props2.fileToKey,\n                track = _props2.track;\n            var file = data.file,\n                name = data.name,\n                size = data.size,\n                type = data.type;\n\n            var key = textKey || path + (0, _Common.calcKey)(data, fileToKey);\n            if (!_storage2.default || typeof _storage2.default.put !== 'function') {\n                throw new Error('No Storage module found, please ensure @aws-amplify/storage is imported');\n            }\n            _storage2.default.put(key, file, {\n                level: level ? level : 'public',\n                contentType: type,\n                track: track\n            }).then(function (data) {\n                logger.debug('handle pick data', data);\n                that.getText(key, level, track);\n            }).catch(function (err) {\n                return logger.debug('handle pick error', err);\n            });\n        }\n    }, {\n        key: 'handleClick',\n        value: function handleClick(evt) {\n            var onClick = this.props.onClick;\n\n            if (onClick) {\n                onClick(evt);\n            }\n        }\n    }, {\n        key: 'componentDidMount',\n        value: function componentDidMount() {\n            this.load();\n        }\n    }, {\n        key: 'componentDidUpdate',\n        value: function componentDidUpdate(prevProps) {\n            var update = prevProps.path !== this.props.path || prevProps.textKey !== this.props.textKey || prevProps.body !== this.props.body;\n            if (update) {\n                this.load();\n            }\n        }\n    }, {\n        key: 'textEl',\n        value: function textEl(text, theme) {\n            if (!text) {\n                return null;\n            }\n\n            var selected = this.props.selected;\n\n            var containerStyle = { position: 'relative' };\n            return _react2.default.createElement(\n                'div',\n                { style: containerStyle, onClick: this.handleClick },\n                _react2.default.createElement(\n                    'pre',\n                    { style: theme.pre },\n                    text\n                ),\n                _react2.default.createElement('div', { style: selected ? theme.overlaySelected : theme.overlay })\n            );\n        }\n    }, {\n        key: 'render',\n        value: function render() {\n            var _props3 = this.props,\n                hidden = _props3.hidden,\n                style = _props3.style,\n                picker = _props3.picker,\n                translate = _props3.translate,\n                textKey = _props3.textKey;\n\n            var text = this.state.text;\n            if (translate) {\n                text = typeof translate === 'string' ? translate : translate({\n                    type: 'text',\n                    key: textKey,\n                    content: text\n                });\n            }\n            if (!text && !picker) {\n                return null;\n            }\n\n            var theme = this.props.theme || _AmplifyTheme2.default;\n            var textStyle = hidden ? _AmplifyTheme2.default.hidden : Object.assign({}, theme.text, style);\n\n            return _react2.default.createElement(\n                'div',\n                { style: textStyle },\n                textStyle ? this.textEl(text, theme) : null,\n                picker ? _react2.default.createElement(\n                    'div',\n                    null,\n                    _react2.default.createElement(_Widget.TextPicker, {\n                        key: 'picker',\n                        onPick: this.handlePick,\n                        theme: theme\n                    })\n                ) : null\n            );\n        }\n    }]);\n    return S3Text;\n}(_react.Component);\n\nexports.default = S3Text;"]},"metadata":{},"sourceType":"script"}