{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _typeof2 = require('babel-runtime/helpers/typeof');\n\nvar _typeof3 = _interopRequireDefault(_typeof2);\n\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = require('babel-runtime/helpers/createClass');\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require('babel-runtime/helpers/inherits');\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _core = require('@aws-amplify/core');\n\nvar _storage = require('@aws-amplify/storage');\n\nvar _storage2 = _interopRequireDefault(_storage);\n\nvar _Widget = require('../Widget');\n\nvar _AmplifyTheme = require('../AmplifyTheme');\n\nvar _AmplifyTheme2 = _interopRequireDefault(_AmplifyTheme);\n\nvar _S3Image = require('./S3Image');\n\nvar _S3Image2 = _interopRequireDefault(_S3Image);\n\nvar _S3Text = require('./S3Text');\n\nvar _S3Text2 = _interopRequireDefault(_S3Text);\n\nvar _Common = require('./Common');\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n/*\n * Copyright 2017-2017 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *     http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\n\n\nvar logger = new _core.ConsoleLogger('Storage.S3Album');\n\nvar S3Album = function (_Component) {\n  (0, _inherits3.default)(S3Album, _Component);\n\n  function S3Album(props) {\n    (0, _classCallCheck3.default)(this, S3Album);\n\n    var _this = (0, _possibleConstructorReturn3.default)(this, (S3Album.__proto__ || Object.getPrototypeOf(S3Album)).call(this, props));\n\n    _this.handlePick = _this.handlePick.bind(_this);\n    _this.handleClick = _this.handleClick.bind(_this);\n    _this.list = _this.list.bind(_this);\n    _this.marshal = _this.marshal.bind(_this);\n    var theme = _this.props.theme || _AmplifyTheme2.default;\n    _this.state = {\n      theme: theme,\n      items: [],\n      ts: new Date().getTime()\n    };\n\n    _core.Hub.listen('window', _this, 'S3Album');\n\n    return _this;\n  }\n\n  (0, _createClass3.default)(S3Album, [{\n    key: 'getKey',\n    value: function getKey(file) {\n      var fileToKey = this.props.fileToKey;\n      var name = file.name,\n          size = file.size,\n          type = file.type;\n      var key = encodeURI(name);\n\n      if (fileToKey) {\n        var callback_type = typeof fileToKey === 'undefined' ? 'undefined' : (0, _typeof3.default)(fileToKey);\n\n        if (callback_type === 'string') {\n          key = fileToKey;\n        } else if (callback_type === 'function') {\n          key = fileToKey({\n            name: name,\n            size: size,\n            type: type\n          });\n        } else {\n          key = encodeURI(JSON.stringify(fileToKey));\n        }\n\n        if (!key) {\n          logger.debug('key is empty');\n          key = 'empty_key';\n        }\n      }\n\n      return key.replace(/\\s/g, '_');\n    }\n  }, {\n    key: 'handlePick',\n    value: function handlePick(data) {\n      var _this2 = this;\n\n      var that = this;\n      var _props = this.props,\n          onPick = _props.onPick,\n          onLoad = _props.onLoad,\n          onError = _props.onError,\n          track = _props.track,\n          level = _props.level;\n\n      if (onPick) {\n        onPick(data);\n      }\n\n      var path = this.props.path || '';\n      var file = data.file,\n          name = data.name,\n          size = data.size,\n          type = data.type;\n      var key = path + this.getKey(data);\n\n      if (!_storage2.default || typeof _storage2.default.put !== 'function') {\n        throw new Error('No Storage module found, please ensure @aws-amplify/storage is imported');\n      }\n\n      _storage2.default.put(key, file, {\n        level: level ? level : 'public',\n        contentType: type,\n        track: track\n      }).then(function (data) {\n        logger.debug('handle pick data', data);\n        var items = _this2.state.items;\n\n        if (items.filter(function (item) {\n          return item.key === key;\n        }).length === 0) {\n          var list = items.concat(data);\n\n          _this2.marshal(list);\n        } else {\n          logger.debug('update an item');\n        }\n\n        if (onLoad) {\n          onLoad(data);\n        }\n      }).catch(function (err) {\n        logger.debug('handle pick error', err);\n\n        if (onError) {\n          onError(err);\n        }\n      });\n\n      this.setState({\n        ts: new Date().getTime()\n      });\n    }\n  }, {\n    key: 'handleClick',\n    value: function handleClick(item) {\n      var _props2 = this.props,\n          onClickItem = _props2.onClickItem,\n          select = _props2.select,\n          onSelect = _props2.onSelect;\n\n      if (onClickItem) {\n        onClickItem(item);\n      }\n\n      if (!select) {\n        return;\n      }\n\n      item.selected = !item.selected;\n      this.setState({\n        items: this.state.items.slice()\n      });\n\n      if (!onSelect) {\n        return;\n      }\n\n      var selected_items = this.state.items.filter(function (item) {\n        return item.selected;\n      });\n      onSelect(item, selected_items);\n    }\n  }, {\n    key: 'onHubCapsule',\n    value: function onHubCapsule(capsule) {\n      var theme = this.props.theme || _AmplifyTheme2.default;\n      this.setState({\n        theme: Object.assign({}, theme)\n      });\n    }\n  }, {\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      this.list();\n    }\n  }, {\n    key: 'componentDidUpdate',\n    value: function componentDidUpdate(prevProps, prevState) {\n      if (this.props.path == prevProps.path && this.props.ts == prevProps.ts && this.props.select == prevProps.select) {\n        return;\n      }\n\n      if (!this.props.select) {\n        this.state.items.forEach(function (item) {\n          return item.selected = false;\n        });\n      }\n\n      if (this.props.onSelect) {\n        this.props.onSelect(null, []);\n      }\n\n      this.list();\n    }\n  }, {\n    key: 'list',\n    value: function list() {\n      var _this3 = this;\n\n      var _props3 = this.props,\n          path = _props3.path,\n          level = _props3.level,\n          track = _props3.track;\n      logger.debug('Album path: ' + path);\n\n      if (!_storage2.default || typeof _storage2.default.list !== 'function') {\n        throw new Error('No Storage module found, please ensure @aws-amplify/storage is imported');\n      }\n\n      return _storage2.default.list(path, {\n        level: level ? level : 'public',\n        track: track\n      }).then(function (data) {\n        logger.debug('album list', data);\n\n        _this3.marshal(data);\n      }).catch(function (err) {\n        logger.warn(err);\n        return [];\n      });\n    }\n  }, {\n    key: 'contentType',\n    value: function contentType(item) {\n      return _core.JS.filenameToContentType(item.key, 'image/*');\n    }\n  }, {\n    key: 'marshal',\n    value: function marshal(list) {\n      var _this4 = this;\n\n      var contentType = this.props.contentType || '';\n      list.forEach(function (item) {\n        if (item.contentType) {\n          return;\n        }\n\n        var isString = typeof contentType === 'string';\n        item.contentType = isString ? contentType : contentType(item);\n\n        if (!item.contentType) {\n          item.contentType = _this4.contentType(item);\n        }\n      });\n      list = this.filter(list);\n      list = this.sort(list);\n      this.setState({\n        items: list\n      });\n    }\n  }, {\n    key: 'filter',\n    value: function filter(list) {\n      var filter = this.props.filter;\n      return filter ? filter(list) : list;\n    }\n  }, {\n    key: 'sort',\n    value: function sort(list) {\n      var sort = this.props.sort;\n      var typeof_sort = typeof sort === 'undefined' ? 'undefined' : (0, _typeof3.default)(sort);\n\n      if (typeof_sort === 'function') {\n        return sort(list);\n      }\n\n      if (['string', 'undefined'].includes(typeof_sort)) {\n        var sort_str = sort ? sort : 'lastModified';\n        var parts = sort_str.split(/\\s+/);\n        var field = parts[0];\n        var dir = parts.length > 1 ? parts[1] : '';\n\n        if (field === 'lastModified') {\n          dir = dir === 'asc' ? 'asc' : 'desc';\n        } else {\n          dir = dir === 'desc' ? 'desc' : 'asc';\n        }\n\n        _core.JS.sortByField(list, field, dir);\n\n        return list;\n      }\n\n      logger.warn('invalid sort. done nothing. should be a string or function');\n      return list;\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _this5 = this;\n\n      var _props4 = this.props,\n          picker = _props4.picker,\n          translateItem = _props4.translateItem,\n          level = _props4.level;\n      var _state = this.state,\n          items = _state.items,\n          ts = _state.ts;\n      var pickerTitle = this.props.pickerTitle || 'Pick';\n      var theme = this.props.theme || _AmplifyTheme2.default;\n      var list = items.map(function (item) {\n        var isText = item.contentType && _core.JS.isTextFile(item.contentType);\n\n        return isText ? _react2.default.createElement(_S3Text2.default, {\n          key: item.key,\n          textKey: item.key,\n          theme: theme,\n          style: theme.albumText,\n          selected: item.selected,\n          translate: translateItem,\n          level: level,\n          onClick: function onClick() {\n            return _this5.handleClick(item);\n          }\n        }) : _react2.default.createElement(_S3Image2.default, {\n          key: item.key,\n          imgKey: item.key,\n          theme: theme,\n          style: theme.albumPhoto,\n          selected: item.selected,\n          translate: translateItem,\n          level: level,\n          onClick: function onClick() {\n            return _this5.handleClick(item);\n          }\n        });\n      });\n      return _react2.default.createElement('div', null, _react2.default.createElement('div', {\n        style: theme.album\n      }, list), picker ? _react2.default.createElement(_Widget.Picker, {\n        key: ts,\n        title: pickerTitle,\n        accept: 'image/*, text/*',\n        onPick: this.handlePick,\n        theme: theme\n      }) : null);\n    }\n  }]);\n  return S3Album;\n}(_react.Component);\n\nexports.default = S3Album;","map":{"version":3,"sources":["/home/ec2-user/environment/amazon-cognito-identity-management-workshop/website/node_modules/aws-amplify-react/dist/Storage/S3Album.js"],"names":["Object","defineProperty","exports","value","_typeof2","require","_typeof3","_interopRequireDefault","_classCallCheck2","_classCallCheck3","_createClass2","_createClass3","_possibleConstructorReturn2","_possibleConstructorReturn3","_inherits2","_inherits3","_react","_react2","_core","_storage","_storage2","_Widget","_AmplifyTheme","_AmplifyTheme2","_S3Image","_S3Image2","_S3Text","_S3Text2","_Common","obj","__esModule","default","logger","ConsoleLogger","S3Album","_Component","props","_this","__proto__","getPrototypeOf","call","handlePick","bind","handleClick","list","marshal","theme","state","items","ts","Date","getTime","Hub","listen","key","getKey","file","fileToKey","name","size","type","encodeURI","callback_type","JSON","stringify","debug","replace","data","_this2","that","_props","onPick","onLoad","onError","track","level","path","put","Error","contentType","then","filter","item","length","concat","catch","err","setState","_props2","onClickItem","select","onSelect","selected","slice","selected_items","onHubCapsule","capsule","assign","componentDidMount","componentDidUpdate","prevProps","prevState","forEach","_this3","_props3","warn","JS","filenameToContentType","_this4","isString","sort","typeof_sort","includes","sort_str","parts","split","field","dir","sortByField","render","_this5","_props4","picker","translateItem","_state","pickerTitle","map","isText","isTextFile","createElement","textKey","style","albumText","translate","onClick","imgKey","albumPhoto","album","Picker","title","accept","Component"],"mappings":"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","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _typeof2 = require('babel-runtime/helpers/typeof');\n\nvar _typeof3 = _interopRequireDefault(_typeof2);\n\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = require('babel-runtime/helpers/createClass');\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require('babel-runtime/helpers/inherits');\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _core = require('@aws-amplify/core');\n\nvar _storage = require('@aws-amplify/storage');\n\nvar _storage2 = _interopRequireDefault(_storage);\n\nvar _Widget = require('../Widget');\n\nvar _AmplifyTheme = require('../AmplifyTheme');\n\nvar _AmplifyTheme2 = _interopRequireDefault(_AmplifyTheme);\n\nvar _S3Image = require('./S3Image');\n\nvar _S3Image2 = _interopRequireDefault(_S3Image);\n\nvar _S3Text = require('./S3Text');\n\nvar _S3Text2 = _interopRequireDefault(_S3Text);\n\nvar _Common = require('./Common');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/*\n * Copyright 2017-2017 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *     http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\n\nvar logger = new _core.ConsoleLogger('Storage.S3Album');\n\nvar S3Album = function (_Component) {\n    (0, _inherits3.default)(S3Album, _Component);\n\n    function S3Album(props) {\n        (0, _classCallCheck3.default)(this, S3Album);\n\n        var _this = (0, _possibleConstructorReturn3.default)(this, (S3Album.__proto__ || Object.getPrototypeOf(S3Album)).call(this, props));\n\n        _this.handlePick = _this.handlePick.bind(_this);\n        _this.handleClick = _this.handleClick.bind(_this);\n        _this.list = _this.list.bind(_this);\n        _this.marshal = _this.marshal.bind(_this);\n\n        var theme = _this.props.theme || _AmplifyTheme2.default;\n        _this.state = {\n            theme: theme,\n            items: [],\n            ts: new Date().getTime()\n        };\n\n        _core.Hub.listen('window', _this, 'S3Album');\n        return _this;\n    }\n\n    (0, _createClass3.default)(S3Album, [{\n        key: 'getKey',\n        value: function getKey(file) {\n            var fileToKey = this.props.fileToKey;\n            var name = file.name,\n                size = file.size,\n                type = file.type;\n\n            var key = encodeURI(name);\n            if (fileToKey) {\n                var callback_type = typeof fileToKey === 'undefined' ? 'undefined' : (0, _typeof3.default)(fileToKey);\n                if (callback_type === 'string') {\n                    key = fileToKey;\n                } else if (callback_type === 'function') {\n                    key = fileToKey({ name: name, size: size, type: type });\n                } else {\n                    key = encodeURI(JSON.stringify(fileToKey));\n                }\n                if (!key) {\n                    logger.debug('key is empty');\n                    key = 'empty_key';\n                }\n            }\n\n            return key.replace(/\\s/g, '_');\n        }\n    }, {\n        key: 'handlePick',\n        value: function handlePick(data) {\n            var _this2 = this;\n\n            var that = this;\n            var _props = this.props,\n                onPick = _props.onPick,\n                onLoad = _props.onLoad,\n                onError = _props.onError,\n                track = _props.track,\n                level = _props.level;\n\n\n            if (onPick) {\n                onPick(data);\n            }\n\n            var path = this.props.path || '';\n            var file = data.file,\n                name = data.name,\n                size = data.size,\n                type = data.type;\n\n            var key = path + this.getKey(data);\n            if (!_storage2.default || typeof _storage2.default.put !== 'function') {\n                throw new Error('No Storage module found, please ensure @aws-amplify/storage is imported');\n            }\n\n            _storage2.default.put(key, file, {\n                level: level ? level : 'public',\n                contentType: type,\n                track: track\n            }).then(function (data) {\n                logger.debug('handle pick data', data);\n                var items = _this2.state.items;\n\n                if (items.filter(function (item) {\n                    return item.key === key;\n                }).length === 0) {\n                    var list = items.concat(data);\n                    _this2.marshal(list);\n                } else {\n                    logger.debug('update an item');\n                }\n                if (onLoad) {\n                    onLoad(data);\n                }\n            }).catch(function (err) {\n                logger.debug('handle pick error', err);\n                if (onError) {\n                    onError(err);\n                }\n            });\n            this.setState({ ts: new Date().getTime() });\n        }\n    }, {\n        key: 'handleClick',\n        value: function handleClick(item) {\n            var _props2 = this.props,\n                onClickItem = _props2.onClickItem,\n                select = _props2.select,\n                onSelect = _props2.onSelect;\n\n            if (onClickItem) {\n                onClickItem(item);\n            }\n\n            if (!select) {\n                return;\n            }\n\n            item.selected = !item.selected;\n            this.setState({ items: this.state.items.slice() });\n\n            if (!onSelect) {\n                return;\n            }\n\n            var selected_items = this.state.items.filter(function (item) {\n                return item.selected;\n            });\n            onSelect(item, selected_items);\n        }\n    }, {\n        key: 'onHubCapsule',\n        value: function onHubCapsule(capsule) {\n            var theme = this.props.theme || _AmplifyTheme2.default;\n            this.setState({ theme: Object.assign({}, theme) });\n        }\n    }, {\n        key: 'componentDidMount',\n        value: function componentDidMount() {\n            this.list();\n        }\n    }, {\n        key: 'componentDidUpdate',\n        value: function componentDidUpdate(prevProps, prevState) {\n            if (this.props.path == prevProps.path && this.props.ts == prevProps.ts && this.props.select == prevProps.select) {\n                return;\n            }\n\n            if (!this.props.select) {\n                this.state.items.forEach(function (item) {\n                    return item.selected = false;\n                });\n            }\n            if (this.props.onSelect) {\n                this.props.onSelect(null, []);\n            }\n\n            this.list();\n        }\n    }, {\n        key: 'list',\n        value: function list() {\n            var _this3 = this;\n\n            var _props3 = this.props,\n                path = _props3.path,\n                level = _props3.level,\n                track = _props3.track;\n\n            logger.debug('Album path: ' + path);\n            if (!_storage2.default || typeof _storage2.default.list !== 'function') {\n                throw new Error('No Storage module found, please ensure @aws-amplify/storage is imported');\n            }\n            return _storage2.default.list(path, { level: level ? level : 'public', track: track }).then(function (data) {\n                logger.debug('album list', data);\n                _this3.marshal(data);\n            }).catch(function (err) {\n                logger.warn(err);\n                return [];\n            });\n        }\n    }, {\n        key: 'contentType',\n        value: function contentType(item) {\n            return _core.JS.filenameToContentType(item.key, 'image/*');\n        }\n    }, {\n        key: 'marshal',\n        value: function marshal(list) {\n            var _this4 = this;\n\n            var contentType = this.props.contentType || '';\n            list.forEach(function (item) {\n                if (item.contentType) {\n                    return;\n                }\n                var isString = typeof contentType === 'string';\n                item.contentType = isString ? contentType : contentType(item);\n                if (!item.contentType) {\n                    item.contentType = _this4.contentType(item);\n                }\n            });\n\n            list = this.filter(list);\n            list = this.sort(list);\n            this.setState({ items: list });\n        }\n    }, {\n        key: 'filter',\n        value: function filter(list) {\n            var filter = this.props.filter;\n\n            return filter ? filter(list) : list;\n        }\n    }, {\n        key: 'sort',\n        value: function sort(list) {\n            var sort = this.props.sort;\n\n            var typeof_sort = typeof sort === 'undefined' ? 'undefined' : (0, _typeof3.default)(sort);\n            if (typeof_sort === 'function') {\n                return sort(list);\n            }\n\n            if (['string', 'undefined'].includes(typeof_sort)) {\n                var sort_str = sort ? sort : 'lastModified';\n                var parts = sort_str.split(/\\s+/);\n                var field = parts[0];\n                var dir = parts.length > 1 ? parts[1] : '';\n                if (field === 'lastModified') {\n                    dir = dir === 'asc' ? 'asc' : 'desc';\n                } else {\n                    dir = dir === 'desc' ? 'desc' : 'asc';\n                }\n                _core.JS.sortByField(list, field, dir);\n\n                return list;\n            }\n\n            logger.warn('invalid sort. done nothing. should be a string or function');\n            return list;\n        }\n    }, {\n        key: 'render',\n        value: function render() {\n            var _this5 = this;\n\n            var _props4 = this.props,\n                picker = _props4.picker,\n                translateItem = _props4.translateItem,\n                level = _props4.level;\n            var _state = this.state,\n                items = _state.items,\n                ts = _state.ts;\n\n\n            var pickerTitle = this.props.pickerTitle || 'Pick';\n\n            var theme = this.props.theme || _AmplifyTheme2.default;\n\n            var list = items.map(function (item) {\n                var isText = item.contentType && _core.JS.isTextFile(item.contentType);\n                return isText ? _react2.default.createElement(_S3Text2.default, {\n                    key: item.key,\n                    textKey: item.key,\n                    theme: theme,\n                    style: theme.albumText,\n                    selected: item.selected,\n                    translate: translateItem,\n                    level: level,\n                    onClick: function onClick() {\n                        return _this5.handleClick(item);\n                    }\n                }) : _react2.default.createElement(_S3Image2.default, {\n                    key: item.key,\n                    imgKey: item.key,\n                    theme: theme,\n                    style: theme.albumPhoto,\n                    selected: item.selected,\n                    translate: translateItem,\n                    level: level,\n                    onClick: function onClick() {\n                        return _this5.handleClick(item);\n                    }\n                });\n            });\n            return _react2.default.createElement(\n                'div',\n                null,\n                _react2.default.createElement(\n                    'div',\n                    { style: theme.album },\n                    list\n                ),\n                picker ? _react2.default.createElement(_Widget.Picker, {\n                    key: ts,\n                    title: pickerTitle,\n                    accept: 'image/*, text/*',\n                    onPick: this.handlePick,\n                    theme: theme\n                }) : null\n            );\n        }\n    }]);\n    return S3Album;\n}(_react.Component);\n\nexports.default = S3Album;"]},"metadata":{},"sourceType":"script"}