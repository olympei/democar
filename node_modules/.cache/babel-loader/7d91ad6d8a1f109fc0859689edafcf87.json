{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = require('babel-runtime/helpers/createClass');\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require('babel-runtime/helpers/inherits');\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _core = require('@aws-amplify/core');\n\nvar _auth = require('@aws-amplify/auth');\n\nvar _auth2 = _interopRequireDefault(_auth);\n\nvar _AmplifyTheme = require('../AmplifyTheme');\n\nvar _AmplifyTheme2 = _interopRequireDefault(_AmplifyTheme);\n\nvar _AmplifyUI = require('../AmplifyUI');\n\nvar _TOTPSetupComp = require('./TOTPSetupComp');\n\nvar _TOTPSetupComp2 = _interopRequireDefault(_TOTPSetupComp);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n/*\n * Copyright 2017-2017 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *     http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\n\n\nvar logger = new _core.ConsoleLogger('SelectMFAType');\n\nvar SelectMFAType = function (_Component) {\n  (0, _inherits3.default)(SelectMFAType, _Component);\n\n  function SelectMFAType(props) {\n    (0, _classCallCheck3.default)(this, SelectMFAType);\n\n    var _this = (0, _possibleConstructorReturn3.default)(this, (SelectMFAType.__proto__ || Object.getPrototypeOf(SelectMFAType)).call(this, props));\n\n    _this.verify = _this.verify.bind(_this);\n    _this.handleInputChange = _this.handleInputChange.bind(_this);\n    _this.state = {\n      TOTPSetup: false,\n      selectMessage: null\n    };\n    return _this;\n  }\n\n  (0, _createClass3.default)(SelectMFAType, [{\n    key: 'handleInputChange',\n    value: function handleInputChange(evt) {\n      // clear current state\n      this.setState({\n        TOTPSetup: false,\n        selectMessage: null\n      });\n      this.inputs = {};\n      var _evt$target = evt.target,\n          name = _evt$target.name,\n          value = _evt$target.value,\n          type = _evt$target.type,\n          checked = _evt$target.checked;\n      var check_type = ['radio', 'checkbox'].includes(type);\n      this.inputs[value] = check_type ? checked : value;\n    }\n  }, {\n    key: 'verify',\n    value: function verify() {\n      var _this2 = this;\n\n      logger.debug('mfatypes inputs', this.inputs);\n\n      if (!this.inputs) {\n        logger.debug('No mfa type selected');\n        return;\n      }\n\n      var _inputs = this.inputs,\n          TOTP = _inputs.TOTP,\n          SMS = _inputs.SMS,\n          NOMFA = _inputs.NOMFA;\n      var mfaMethod = null;\n\n      if (TOTP) {\n        mfaMethod = 'TOTP';\n      } else if (SMS) {\n        mfaMethod = 'SMS';\n      } else if (NOMFA) {\n        mfaMethod = 'NOMFA';\n      }\n\n      var user = this.props.authData;\n\n      if (!_auth2.default || typeof _auth2.default.setPreferredMFA !== 'function') {\n        throw new Error('No Auth module found, please ensure @aws-amplify/auth is imported');\n      }\n\n      _auth2.default.setPreferredMFA(user, mfaMethod).then(function (data) {\n        logger.debug('set preferred mfa success', data);\n\n        _this2.setState({\n          selectMessage: 'Successful! Now you have changed to MFA Type: ' + mfaMethod\n        });\n      }).catch(function (err) {\n        var message = err.message;\n\n        if (message === 'User has not set up software token mfa' || message === 'User has not verified software token mfa') {\n          _this2.setState({\n            TOTPSetup: true\n          });\n\n          _this2.setState({\n            selectMessage: 'You need to setup TOTP'\n          });\n        } else {\n          logger.debug('set preferred mfa failed', err);\n\n          _this2.setState({\n            selectMessage: 'Failed! You cannot select MFA Type for now!'\n          });\n        }\n      });\n    }\n  }, {\n    key: 'selectView',\n    value: function selectView(theme) {\n      var MFATypes = this.props.MFATypes;\n\n      if (!MFATypes || Object.keys(MFATypes).length < 2) {\n        logger.debug('less than 2 mfa types available');\n        return _react2.default.createElement('div', null, _react2.default.createElement('a', null, 'less than 2 mfa types available'));\n      }\n\n      var SMS = MFATypes.SMS,\n          TOTP = MFATypes.TOTP,\n          Optional = MFATypes.Optional;\n      return _react2.default.createElement(_AmplifyUI.FormSection, {\n        theme: theme\n      }, _react2.default.createElement(_AmplifyUI.SectionHeader, {\n        theme: theme\n      }, _core.I18n.get('Select MFA Type')), _react2.default.createElement(_AmplifyUI.SectionBody, {\n        theme: theme\n      }, _react2.default.createElement(_AmplifyUI.MessageRow, {\n        theme: theme\n      }, _core.I18n.get('Select your preferred MFA Type')), _react2.default.createElement('div', null, SMS ? _react2.default.createElement(_AmplifyUI.RadioRow, {\n        placeholder: _core.I18n.get('SMS'),\n        theme: theme,\n        key: 'sms',\n        name: 'MFAType',\n        value: 'SMS',\n        onChange: this.handleInputChange\n      }) : null, TOTP ? _react2.default.createElement(_AmplifyUI.RadioRow, {\n        placeholder: _core.I18n.get('TOTP'),\n        theme: theme,\n        key: 'totp',\n        name: 'MFAType',\n        value: 'TOTP',\n        onChange: this.handleInputChange\n      }) : null, Optional ? _react2.default.createElement(_AmplifyUI.RadioRow, {\n        placeholder: _core.I18n.get('No MFA'),\n        theme: theme,\n        key: 'noMFA',\n        name: 'MFAType',\n        value: 'NOMFA',\n        onChange: this.handleInputChange\n      }) : null, _react2.default.createElement(_AmplifyUI.ButtonRow, {\n        theme: theme,\n        onClick: this.verify\n      }, _core.I18n.get('Verify'))), this.state.selectMessage ? _react2.default.createElement(_AmplifyUI.MessageRow, {\n        theme: theme\n      }, _core.I18n.get(this.state.selectMessage)) : null));\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var theme = this.props.theme ? theme : _AmplifyTheme2.default;\n      return _react2.default.createElement('div', null, this.selectView(theme), this.state.TOTPSetup ? _react2.default.createElement(_TOTPSetupComp2.default, this.props) : null);\n    }\n  }]);\n  return SelectMFAType;\n}(_react.Component);\n\nexports.default = SelectMFAType;","map":{"version":3,"sources":["/home/ec2-user/environment/amazon-cognito-identity-management-workshop/website/node_modules/aws-amplify-react/dist/Widget/SelectMFAType.js"],"names":["Object","defineProperty","exports","value","_classCallCheck2","require","_classCallCheck3","_interopRequireDefault","_createClass2","_createClass3","_possibleConstructorReturn2","_possibleConstructorReturn3","_inherits2","_inherits3","_react","_react2","_core","_auth","_auth2","_AmplifyTheme","_AmplifyTheme2","_AmplifyUI","_TOTPSetupComp","_TOTPSetupComp2","obj","__esModule","default","logger","ConsoleLogger","SelectMFAType","_Component","props","_this","__proto__","getPrototypeOf","call","verify","bind","handleInputChange","state","TOTPSetup","selectMessage","key","evt","setState","inputs","_evt$target","target","name","type","checked","check_type","includes","_this2","debug","_inputs","TOTP","SMS","NOMFA","mfaMethod","user","authData","setPreferredMFA","Error","then","data","catch","err","message","selectView","theme","MFATypes","keys","length","createElement","Optional","FormSection","SectionHeader","I18n","get","SectionBody","MessageRow","RadioRow","placeholder","onChange","ButtonRow","onClick","render","Component"],"mappings":"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","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = require('babel-runtime/helpers/createClass');\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require('babel-runtime/helpers/inherits');\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _core = require('@aws-amplify/core');\n\nvar _auth = require('@aws-amplify/auth');\n\nvar _auth2 = _interopRequireDefault(_auth);\n\nvar _AmplifyTheme = require('../AmplifyTheme');\n\nvar _AmplifyTheme2 = _interopRequireDefault(_AmplifyTheme);\n\nvar _AmplifyUI = require('../AmplifyUI');\n\nvar _TOTPSetupComp = require('./TOTPSetupComp');\n\nvar _TOTPSetupComp2 = _interopRequireDefault(_TOTPSetupComp);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/*\n * Copyright 2017-2017 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *     http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\n\nvar logger = new _core.ConsoleLogger('SelectMFAType');\n\nvar SelectMFAType = function (_Component) {\n    (0, _inherits3.default)(SelectMFAType, _Component);\n\n    function SelectMFAType(props) {\n        (0, _classCallCheck3.default)(this, SelectMFAType);\n\n        var _this = (0, _possibleConstructorReturn3.default)(this, (SelectMFAType.__proto__ || Object.getPrototypeOf(SelectMFAType)).call(this, props));\n\n        _this.verify = _this.verify.bind(_this);\n        _this.handleInputChange = _this.handleInputChange.bind(_this);\n\n        _this.state = {\n            TOTPSetup: false,\n            selectMessage: null\n        };\n        return _this;\n    }\n\n    (0, _createClass3.default)(SelectMFAType, [{\n        key: 'handleInputChange',\n        value: function handleInputChange(evt) {\n            // clear current state\n            this.setState({\n                TOTPSetup: false,\n                selectMessage: null\n            });\n            this.inputs = {};\n            var _evt$target = evt.target,\n                name = _evt$target.name,\n                value = _evt$target.value,\n                type = _evt$target.type,\n                checked = _evt$target.checked;\n\n            var check_type = ['radio', 'checkbox'].includes(type);\n            this.inputs[value] = check_type ? checked : value;\n        }\n    }, {\n        key: 'verify',\n        value: function verify() {\n            var _this2 = this;\n\n            logger.debug('mfatypes inputs', this.inputs);\n            if (!this.inputs) {\n                logger.debug('No mfa type selected');\n                return;\n            }\n            var _inputs = this.inputs,\n                TOTP = _inputs.TOTP,\n                SMS = _inputs.SMS,\n                NOMFA = _inputs.NOMFA;\n\n            var mfaMethod = null;\n            if (TOTP) {\n                mfaMethod = 'TOTP';\n            } else if (SMS) {\n                mfaMethod = 'SMS';\n            } else if (NOMFA) {\n                mfaMethod = 'NOMFA';\n            }\n\n            var user = this.props.authData;\n\n            if (!_auth2.default || typeof _auth2.default.setPreferredMFA !== 'function') {\n                throw new Error('No Auth module found, please ensure @aws-amplify/auth is imported');\n            }\n\n            _auth2.default.setPreferredMFA(user, mfaMethod).then(function (data) {\n                logger.debug('set preferred mfa success', data);\n                _this2.setState({ selectMessage: 'Successful! Now you have changed to MFA Type: ' + mfaMethod });\n            }).catch(function (err) {\n                var message = err.message;\n\n                if (message === 'User has not set up software token mfa' || message === 'User has not verified software token mfa') {\n                    _this2.setState({ TOTPSetup: true });\n                    _this2.setState({ selectMessage: 'You need to setup TOTP' });\n                } else {\n                    logger.debug('set preferred mfa failed', err);\n                    _this2.setState({ selectMessage: 'Failed! You cannot select MFA Type for now!' });\n                }\n            });\n        }\n    }, {\n        key: 'selectView',\n        value: function selectView(theme) {\n            var MFATypes = this.props.MFATypes;\n\n            if (!MFATypes || Object.keys(MFATypes).length < 2) {\n                logger.debug('less than 2 mfa types available');\n                return _react2.default.createElement(\n                    'div',\n                    null,\n                    _react2.default.createElement(\n                        'a',\n                        null,\n                        'less than 2 mfa types available'\n                    )\n                );\n            }\n            var SMS = MFATypes.SMS,\n                TOTP = MFATypes.TOTP,\n                Optional = MFATypes.Optional;\n\n            return _react2.default.createElement(\n                _AmplifyUI.FormSection,\n                { theme: theme },\n                _react2.default.createElement(\n                    _AmplifyUI.SectionHeader,\n                    { theme: theme },\n                    _core.I18n.get('Select MFA Type')\n                ),\n                _react2.default.createElement(\n                    _AmplifyUI.SectionBody,\n                    { theme: theme },\n                    _react2.default.createElement(\n                        _AmplifyUI.MessageRow,\n                        { theme: theme },\n                        _core.I18n.get('Select your preferred MFA Type')\n                    ),\n                    _react2.default.createElement(\n                        'div',\n                        null,\n                        SMS ? _react2.default.createElement(_AmplifyUI.RadioRow, {\n                            placeholder: _core.I18n.get('SMS'),\n                            theme: theme,\n                            key: 'sms',\n                            name: 'MFAType',\n                            value: 'SMS',\n                            onChange: this.handleInputChange\n                        }) : null,\n                        TOTP ? _react2.default.createElement(_AmplifyUI.RadioRow, {\n                            placeholder: _core.I18n.get('TOTP'),\n                            theme: theme,\n                            key: 'totp',\n                            name: 'MFAType',\n                            value: 'TOTP',\n                            onChange: this.handleInputChange\n                        }) : null,\n                        Optional ? _react2.default.createElement(_AmplifyUI.RadioRow, {\n                            placeholder: _core.I18n.get('No MFA'),\n                            theme: theme,\n                            key: 'noMFA',\n                            name: 'MFAType',\n                            value: 'NOMFA',\n                            onChange: this.handleInputChange\n                        }) : null,\n                        _react2.default.createElement(\n                            _AmplifyUI.ButtonRow,\n                            { theme: theme, onClick: this.verify },\n                            _core.I18n.get('Verify')\n                        )\n                    ),\n                    this.state.selectMessage ? _react2.default.createElement(\n                        _AmplifyUI.MessageRow,\n                        { theme: theme },\n                        _core.I18n.get(this.state.selectMessage)\n                    ) : null\n                )\n            );\n        }\n    }, {\n        key: 'render',\n        value: function render() {\n            var theme = this.props.theme ? theme : _AmplifyTheme2.default;\n            return _react2.default.createElement(\n                'div',\n                null,\n                this.selectView(theme),\n                this.state.TOTPSetup ? _react2.default.createElement(_TOTPSetupComp2.default, this.props) : null\n            );\n        }\n    }]);\n    return SelectMFAType;\n}(_react.Component);\n\nexports.default = SelectMFAType;"]},"metadata":{},"sourceType":"script"}